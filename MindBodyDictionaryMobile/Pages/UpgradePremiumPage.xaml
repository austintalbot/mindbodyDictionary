<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:pageModels="clr-namespace:MindBodyDictionaryMobile.PageModels"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:Class="MindBodyDictionaryMobile.Pages.UpgradePremiumPage"
             x:DataType="pageModels:UpgradePremiumPageModel"
             Title="Premium"
             x:Name="UpgradePage">

    <ContentPage.Behaviors>
        <toolkit:EventToCommandBehavior
            EventName="NavigatedTo"
            Command="{Binding NavigatedToCommand}" />
    </ContentPage.Behaviors>

    <Grid RowDefinitions="*,Auto">
        <!-- Main Content -->
        <ScrollView Grid.Row="0">
            <VerticalStackLayout Margin="{StaticResource LayoutPadding}" Spacing="{StaticResource LayoutSpacing}">
                
                <!-- Premium Badge -->
                <Border Style="{StaticResource CardStyle}">
                    <VerticalStackLayout Spacing="15">
                        <Label Text="✨ PREMIUM MEMBERSHIP" 
                               Style="{StaticResource Title2}"
                               HorizontalTextAlignment="Center" />
                    </VerticalStackLayout>
                </Border>

                <!-- Features List -->
                <VerticalStackLayout Spacing="{StaticResource LayoutSpacing}">
                    <Label Text="What You Get:" Style="{StaticResource Title3}" />
                    
                    <!-- Feature 1 -->
                    <Border Style="{StaticResource CardStyle}">
                        <Grid ColumnDefinitions="Auto,*">
                            <Label Grid.Column="0" Text="✓" FontSize="24" FontAttributes="Bold" Margin="0,0,12,0" />
                            <VerticalStackLayout Grid.Column="1" Spacing="5">
                                <Label Text="Unlimited Projects" Style="{StaticResource Body1Strong}" />
                                <Label Text="Create and manage unlimited projects" Style="{StaticResource Caption1}" Opacity="0.7" />
                            </VerticalStackLayout>
                        </Grid>
                    </Border>

                    <!-- Feature 2 -->
                    <Border Style="{StaticResource CardStyle}">
                        <Grid ColumnDefinitions="Auto,*">
                            <Label Grid.Column="0" Text="✓" FontSize="24" FontAttributes="Bold" Margin="0,0,12,0" />
                            <VerticalStackLayout Grid.Column="1" Spacing="5">
                                <Label Text="Custom Lists" Style="{StaticResource Body1Strong}" />
                                <Label Text="Organize with unlimited custom lists" Style="{StaticResource Caption1}" Opacity="0.7" />
                            </VerticalStackLayout>
                        </Grid>
                    </Border>

                    <!-- Feature 3 -->
                    <Border Style="{StaticResource CardStyle}">
                        <Grid ColumnDefinitions="Auto,*">
                            <Label Grid.Column="0" Text="✓" FontSize="24" FontAttributes="Bold" Margin="0,0,12,0" />
                            <VerticalStackLayout Grid.Column="1" Spacing="5">
                                <Label Text="Advanced Analytics" Style="{StaticResource Body1Strong}" />
                                <Label Text="Detailed insights and progress tracking" Style="{StaticResource Caption1}" Opacity="0.7" />
                            </VerticalStackLayout>
                        </Grid>
                    </Border>

                    <!-- Feature 4 -->
                    <Border Style="{StaticResource CardStyle}">
                        <Grid ColumnDefinitions="Auto,*">
                            <Label Grid.Column="0" Text="✓" FontSize="24" FontAttributes="Bold" Margin="0,0,12,0" />
                            <VerticalStackLayout Grid.Column="1" Spacing="5">
                                <Label Text="Priority Support" Style="{StaticResource Body1Strong}" />
                                <Label Text="Get help faster with priority support" Style="{StaticResource Caption1}" Opacity="0.7" />
                            </VerticalStackLayout>
                        </Grid>
                    </Border>
                </VerticalStackLayout>

                <!-- Product Info -->
                <VerticalStackLayout Spacing="5">
                    <Label Text="Subscription Details" Style="{StaticResource Title3}" />
                    <Border Style="{StaticResource CardStyle}">
                        <Grid ColumnDefinitions="*,Auto">
                            <VerticalStackLayout Grid.Column="0" Spacing="5">
                                <Label Text="MindBody Dictionary Premium" Style="{StaticResource Body1Strong}" />
                                <Label Text="Annual Subscription" Style="{StaticResource Caption1}" Opacity="0.7" />
                            </VerticalStackLayout>
                            <Label Grid.Column="1" 
                                   Text="{Binding PremiumProduct.Price, StringFormat='{0}'}"
                                   Style="{StaticResource Title2}"
                                   VerticalOptions="Center"
                                   HorizontalTextAlignment="End" />
                        </Grid>
                    </Border>
                    <Label Text="Renews annually. Cancel anytime in your app store settings." 
                           Style="{StaticResource Caption2}" 
                           Opacity="0.6"
                           Margin="0,10,0,0" />
                </VerticalStackLayout>

                <!-- Status Message -->
                <Label Text="{Binding IsPremium, StringFormat='Premium Status: {0:Active|Inactive}'}" 
                       Style="{StaticResource Body1Strong}"
                       IsVisible="{Binding IsPremium}" />

                <!-- Action Buttons -->
                <VerticalStackLayout Spacing="{StaticResource LayoutSpacing}" Padding="0,20,0,0">
                    <Button Text="{Binding ButtonText}"
                            Command="{Binding PurchasePremiumCommand}"
                            IsEnabled="{Binding CanPurchase}"
                            Padding="15,12" />

                    <Button Text="Restore Purchases"
                            Command="{Binding RestorePurchasesCommand}"
                            IsEnabled="{Binding IsBusy, StringFormat='!{0}'}"
                            Padding="15,12"
                            BackgroundColor="Transparent"
                            BorderColor="{AppThemeBinding Light={StaticResource DarkOnLightBackground}, Dark={StaticResource LightOnDarkBackground}}"
                            BorderWidth="1"
                            TextColor="{AppThemeBinding Light={StaticResource DarkOnLightBackground}, Dark={StaticResource LightOnDarkBackground}}" />
                </VerticalStackLayout>
            </VerticalStackLayout>
        </ScrollView>

        <!-- Loading Indicator -->
        <ActivityIndicator Grid.Row="0"
                           IsRunning="{Binding IsBusy}"
                           IsVisible="{Binding IsBusy}"
                           Scale="1.5" />

        <!-- Empty State - Show when PremiumProduct is null -->
        <VerticalStackLayout Grid.Row="0"
                            Spacing="{StaticResource LayoutSpacing}"
                            Padding="{StaticResource LayoutPadding}"
                            HorizontalOptions="Center"
                            VerticalOptions="Center"
                            IsVisible="{Binding PremiumProduct, TargetNullValue=true, FallbackValue=false}">
            <Label Text="Loading Premium Options..."
                   Style="{StaticResource Body1}"
                   HorizontalTextAlignment="Center" />
        </VerticalStackLayout>
    </Grid>
</ContentPage>
