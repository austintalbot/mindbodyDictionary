<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:pageModels="clr-namespace:MindBodyDictionaryMobile.PageModels"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:Class="MindBodyDictionaryMobile.Pages.UpgradePremiumPage"
             x:DataType="pageModels:UpgradePremiumPageModel"
             Title="Premium"
             x:Name="UpgradePage">

    <ContentPage.Behaviors>
        <toolkit:EventToCommandBehavior
            EventName="NavigatedTo"
            Command="{Binding NavigatedToCommand}" />
    </ContentPage.Behaviors>

    <ContentPage.Resources>
        <ResourceDictionary>
            <toolkit:InvertedBoolConverter x:Key="InvertedBoolConverter" />
            <DataTemplate x:Key="PremiumTemplate">
                <Grid RowDefinitions="Auto,Auto,Auto,Auto,Auto" RowSpacing="20" Padding="20">
                    <!-- Premium Badge -->
                    <Frame Grid.Row="0" 
                           BorderColor="{AppThemeBinding Light=#17171a, Dark=#FFFFFF}"
                           HasShadow="True"
                           CornerRadius="15"
                           Padding="0"
                           Margin="0">
                        <StackLayout Padding="20" Spacing="15">
                            <Label Text="✨ PREMIUM MEMBERSHIP" 
                                   FontSize="20"
                                   FontAttributes="Bold"
                                   HorizontalTextAlignment="Center" />
                        </StackLayout>
                    </Frame>

                    <!-- Features List -->
                    <StackLayout Grid.Row="1" Spacing="15">
                        <Label Text="What You Get:" FontSize="18" FontAttributes="Bold" />
                        
                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="12" Padding="0,10">
                            <Label Grid.Column="0" Text="✓" FontSize="24" FontAttributes="Bold" TextColor="{AppThemeBinding Light=#17171a, Dark=#FFFFFF}" />
                            <StackLayout Grid.Column="1" Spacing="0">
                                <Label Text="Unlimited Projects" FontSize="16" FontAttributes="Bold" />
                                <Label Text="Create and manage unlimited projects" FontSize="14" Opacity="0.7" />
                            </StackLayout>
                        </Grid>

                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="12" Padding="0,10">
                            <Label Grid.Column="0" Text="✓" FontSize="24" FontAttributes="Bold" TextColor="{AppThemeBinding Light=#17171a, Dark=#FFFFFF}" />
                            <StackLayout Grid.Column="1" Spacing="0">
                                <Label Text="Custom Lists" FontSize="16" FontAttributes="Bold" />
                                <Label Text="Organize with unlimited custom lists" FontSize="14" Opacity="0.7" />
                            </StackLayout>
                        </Grid>

                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="12" Padding="0,10">
                            <Label Grid.Column="0" Text="✓" FontSize="24" FontAttributes="Bold" TextColor="{AppThemeBinding Light=#17171a, Dark=#FFFFFF}" />
                            <StackLayout Grid.Column="1" Spacing="0">
                                <Label Text="Advanced Analytics" FontSize="16" FontAttributes="Bold" />
                                <Label Text="Detailed insights and progress tracking" FontSize="14" Opacity="0.7" />
                            </StackLayout>
                        </Grid>

                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="12" Padding="0,10">
                            <Label Grid.Column="0" Text="✓" FontSize="24" FontAttributes="Bold" TextColor="{AppThemeBinding Light=#17171a, Dark=#FFFFFF}" />
                            <StackLayout Grid.Column="1" Spacing="0">
                                <Label Text="Priority Support" FontSize="16" FontAttributes="Bold" />
                                <Label Text="Get help faster with priority support" FontSize="14" Opacity="0.7" />
                            </StackLayout>
                        </Grid>
                    </StackLayout>

                    <!-- Product Info -->
                    <StackLayout Grid.Row="2" Spacing="10">
                        <Label Text="Subscription Details" FontSize="18" FontAttributes="Bold" />
                        <Grid ColumnDefinitions="*,Auto" Padding="15" 
                              BackgroundColor="{AppThemeBinding Light=#F5F5F5, Dark=#2C2C2C}"
                              CornerRadius="10">
                            <StackLayout Grid.Column="0" Spacing="5">
                                <Label Text="MindBody Dictionary Premium" FontSize="16" FontAttributes="Bold" />
                                <Label Text="Annual Subscription" FontSize="14" Opacity="0.7" />
                            </StackLayout>
                            <Label Grid.Column="1" 
                                   Text="{Binding PremiumProduct.Price, StringFormat='{0}'}"
                                   FontSize="20"
                                   FontAttributes="Bold"
                                   VerticalOptions="Center"
                                   HorizontalTextAlignment="End" />
                        </Grid>
                        <Label Text="Renews annually. Cancel anytime in your app store settings." 
                               FontSize="12" 
                               Opacity="0.6"
                               Margin="0,5" />
                    </StackLayout>

                    <!-- Status Message -->
                    <StackLayout Grid.Row="3" Spacing="10">
                        <Label Text="{Binding IsPremium, StringFormat='Premium Status: {0:Active|Inactive}'}" 
                               FontSize="16" 
                               FontAttributes="Bold"
                               IsVisible="{Binding IsPremium}" />
                    </StackLayout>

                    <!-- Action Buttons -->
                    <StackLayout Grid.Row="4" Spacing="10" Padding="0,10">
                        <Button Text="{Binding ButtonText}"
                                Command="{Binding PurchasePremiumCommand}"
                                IsEnabled="{Binding CanPurchase, Converter={StaticResource InvertedBoolConverter}}"
                                Padding="15"
                                FontSize="18"
                                FontAttributes="Bold"
                                BackgroundColor="{AppThemeBinding Light=#17171a, Dark=#FFFFFF}"
                                TextColor="{AppThemeBinding Light=#FFFFFF, Dark=#17171a}"
                                CornerRadius="10" />

                        <Button Text="Restore Purchases"
                                Command="{Binding RestorePurchasesCommand}"
                                IsEnabled="{Binding IsBusy, Converter={StaticResource InvertedBoolConverter}}"
                                Padding="15"
                                FontSize="16"
                                BackgroundColor="{AppThemeBinding Light=#E8E8E8, Dark=#3C3C3C}"
                                TextColor="{AppThemeBinding Light=#17171a, Dark=#FFFFFF}"
                                CornerRadius="10"
                                BorderColor="{AppThemeBinding Light=#17171a, Dark=#FFFFFF}"
                                BorderWidth="1" />
                    </StackLayout>
                </Grid>
            </DataTemplate>
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid RowDefinitions="*,Auto" 
          Padding="0"
          BackgroundColor="{AppThemeBinding Light=#FFFFFF, Dark=#17171a}">
        
        <!-- Main Content -->
        <ScrollView Grid.Row="0">
            <ContentView Content="{Binding PremiumProduct, TemplateBinding DataTemplate}"
                        ContentTemplate="{StaticResource PremiumTemplate}" />
        </ScrollView>

        <!-- Loading Indicator -->
        <ActivityIndicator Grid.Row="0"
                          IsRunning="{Binding IsBusy}"
                          IsVisible="{Binding IsBusy}"
                          Scale="1.5" />

        <!-- Empty State -->
        <StackLayout Grid.Row="0"
                    Spacing="20"
                    Padding="30"
                    HorizontalOptions="Center"
                    VerticalOptions="Center"
                    IsVisible="{Binding PremiumProduct, Converter={StaticResource InvertedBoolConverter}}">
            <Label Text="Loading Premium Options..."
                   FontSize="18"
                   HorizontalTextAlignment="Center" />
        </StackLayout>
    </Grid>
</ContentPage>
