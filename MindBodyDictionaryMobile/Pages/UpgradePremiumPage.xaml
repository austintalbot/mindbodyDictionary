<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:pageModels="clr-namespace:MindBodyDictionaryMobile.PageModels"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:Class="MindBodyDictionaryMobile.Pages.UpgradePremiumPage"
             x:DataType="pageModels:UpgradePremiumPageModel"
             Title="{Binding Title}">

    <ContentPage.Behaviors>
        <toolkit:EventToCommandBehavior
            EventName="NavigatedTo"
            Command="{Binding NavigatedCommand}" />
    </ContentPage.Behaviors>

    <Grid RowDefinitions="*,Auto">
        <!-- Main Content -->
        <ScrollView Grid.Row="0">
            <VerticalStackLayout Margin="20" Spacing="20">
                
                <!-- Logo -->
                <Image Source="mbd_logo.png"
                       HeightRequest="150"
                       HorizontalOptions="Center"
                       Aspect="AspectFit"
                       SemanticProperties.Description="Mind Body Dictionary Logo" />

                <!-- Description -->
                <Label Text="Enjoy an ad free experience while helping support development."
                       IsVisible="{Binding IsSubscribed, StringFormat='!{0}'}"
                       HorizontalOptions="CenterAndExpand"
                       HorizontalTextAlignment="Center"
                       FontSize="20" />

                <!-- Terms -->
                <Label Text="No trial period, and the subscription will be renewed automatically on the subscription date, unless canceled before the renewal date."
                       IsVisible="{Binding IsSubscribed, StringFormat='!{0}'}"
                       HorizontalOptions="CenterAndExpand"
                       HorizontalTextAlignment="Center"
                       FontSize="16" />

                <!-- Subscription Buttons -->
                <VerticalStackLayout Spacing="10" Padding="0,20,0,0">
                    <Button Text="{Binding IsBusy, StringFormat='Loading...', TargetNullValue='Subscribe for $9.99/year'}"
                            Command="{Binding PurchaseCommand}"
                            IsVisible="{Binding IsSubscribed, StringFormat='!{0}'}"
                            IsEnabled="{Binding IsBusy, StringFormat='!{0}'}"
                            Padding="15,12" />

                    <Button Text="{Binding IsBusy, StringFormat='Restoring...', TargetNullValue='Restore Subscription'}"
                            Command="{Binding RestoreCommand}"
                            IsVisible="{Binding IsSubscribed, StringFormat='!{0}'}"
                            IsEnabled="{Binding IsBusy, StringFormat='!{0}'}"
                            Padding="15,12"
                            BackgroundColor="Transparent"
                            BorderColor="{AppThemeBinding Light=#000000, Dark=#FFFFFF}"
                            BorderWidth="1" />
                </VerticalStackLayout>

                <!-- Subscription Active Message -->
                <Label Text="âœ“ Premium Active"
                       IsVisible="{Binding IsSubscribed}"
                       HorizontalOptions="CenterAndExpand"
                       FontSize="18"
                       FontAttributes="Bold"
                       TextColor="Green" />

                <!-- Legal Links -->
                <VerticalStackLayout Spacing="10" Padding="0,20,0,0">
                    <Button Text="Privacy Policy"
                            Command="{Binding PrivacyCommand}"
                            BackgroundColor="Transparent"
                            TextColor="{AppThemeBinding Light=#0066CC, Dark=#66B3FF}"
                            Padding="10,8" />

                    <Button Text="Terms of Use"
                            Command="{Binding TermsCommand}"
                            CommandParameter="https://www.mindbodydictionary.com/termsandconditions"
                            BackgroundColor="Transparent"
                            TextColor="{AppThemeBinding Light=#0066CC, Dark=#66B3FF}"
                            Padding="10,8" />
                </VerticalStackLayout>
            </VerticalStackLayout>
        </ScrollView>

        <!-- Loading Indicator -->
        <ActivityIndicator Grid.Row="0"
                           IsRunning="{Binding IsBusy}"
                           IsVisible="{Binding IsBusy}"
                           Scale="1.5" />
    </Grid>
</ContentPage>
