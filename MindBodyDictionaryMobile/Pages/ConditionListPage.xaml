<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:pageModels="clr-namespace:MindBodyDictionaryMobile.PageModels"
             xmlns:models="clr-namespace:MindBodyDictionaryMobile.Models"
             xmlns:controls="clr-namespace:MindBodyDictionaryMobile.Pages.Controls"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:Class="MindBodyDictionaryMobile.Pages.ConditionListPage"
             x:Name="ConditionList"
             x:DataType="pageModels:ConditionListPageModel"
             Title="Conditions">


    <ContentPage.Behaviors>
        <toolkit:EventToCommandBehavior
            EventName="Appearing"
            Command="{Binding AppearingCommand}"/>
    </ContentPage.Behaviors>
    <Grid RowDefinitions="Auto,*,Auto">
      <VerticalStackLayout Grid.Row="0" Padding="12" Spacing="4" BackgroundColor="{AppThemeBinding Light=#FFF3CD, Dark=#5C4820}">
        <Label Text="ðŸ” DEBUG INFO" FontSize="14" FontAttributes="Bold" />
        <Label Text="{Binding Conditions.Count, StringFormat='Conditions Count: {0}'}" FontSize="12" />
        <Label Text="{Binding StatusMessage}" FontSize="11" TextColor="{AppThemeBinding Light=#333333, Dark=#CCCCCC}" />
      </VerticalStackLayout>

      <ScrollView Grid.Row="1">
        <VerticalStackLayout
            BindableLayout.ItemsSource="{Binding Conditions}"
            Margin="{StaticResource LayoutPadding}"
            Spacing="{StaticResource LayoutSpacing}">
            <BindableLayout.ItemTemplate>
                <DataTemplate x:DataType="models:MbdCondition">
                    <Border
                        Padding="16"
                        Stroke="{AppThemeBinding Light=#E0E0E0, Dark=#333333}"
                        StrokeThickness="1"
                        StrokeShape="RoundRectangle 8,8,8,8"
                        SemanticProperties.Description="{Binding Name, StringFormat='{0} Condition'}">
                        <VerticalStackLayout Spacing="8">
                            <Label
                                Text="{Binding Name}"
                                FontSize="20"
                                FontAttributes="Bold"
                                TextColor="{AppThemeBinding Light=#000000, Dark=#FFFFFF}" />
                        </VerticalStackLayout>
                        <Border.GestureRecognizers>
                            <TapGestureRecognizer
                                Command="{Binding NavigateToConditionCommand, Source={RelativeSource AncestorType={x:Type pageModels:ConditionListPageModel}}, x:DataType=pageModels:ConditionListPageModel}"
                                CommandParameter="{Binding .}"/>
                        </Border.GestureRecognizers>
                    </Border>
                </DataTemplate>
            </BindableLayout.ItemTemplate>
        </VerticalStackLayout>
      </ScrollView>

      <controls:AddButton
          Grid.Row="2"
          Command="{Binding AddConditionCommand}"
          SemanticProperties.Description="Add condition" />
    </Grid>
</ContentPage>
